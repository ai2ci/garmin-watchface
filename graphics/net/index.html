<html>
    <head>
        <!-- <link rel="stylesheet" href="./bg.css" /> -->
    </head>
    <body>
        <div class="content" style="margin-top: 15px;margin-left: 15px;">

            <canvas id="canvas" height="1400" width="1400">
            </canvas>
        </div>
        <script>
            const pointWidth = 5;
            const squareLenght = 260;
            const lenght = squareLenght * 5;
            const radius = squareLenght * 5 / 2;

            function draw() {
                const canvas = document.querySelector('#canvas');

                if (!canvas.getContext) {
                    return;
                }
                const ctx = canvas.getContext('2d');

                // set line stroke and line width
                ctx.strokeStyle = 'red';
                ctx.lineWidth = 1;

                // ctx.beginPath();
                // ctx.arc(leftOffset + radius, topOffset + radius, radius, 0, Math.PI * 2);
                // ctx.clip();
                let region = new Path2D();
                region.arc(radius, radius, radius, 0, Math.PI * 2);
                region.arc(radius, radius, 10 * pointWidth, 0, Math.PI * 2);
                ctx.clip(region, 'evenodd');

                for(let i = 0 ; i < squareLenght + 1 ; i++ ) {
                    ctx.lineWidth = 0.1;
                    ctx.strokeStyle = i % 10 === 0 ? 'black' : 'red';

                    ctx.beginPath();
                    ctx.moveTo(pointWidth * i, 0);
                    ctx.lineTo(pointWidth * i, squareLenght * pointWidth);
                    ctx.stroke();

                    ctx.beginPath();
                    ctx.moveTo(0, pointWidth * i);
                    ctx.lineTo(squareLenght * pointWidth, pointWidth * i);
                    ctx.stroke();
                }

                ctx.strokeStyle = 'red';
                ctx.lineWidth = 1;

                const r = squareLenght / 2;

                const distances = [0, -4, -8, -10, -15, -20, -30, -40, -50, -60, -70, -80];
                const sides = [3, 5, 6,  9, 10, 12];
                const out = [];
                // create ticks
                for(let angle = 0 ; angle < Math.PI * 2 ; angle += Math.PI / 30.0) {
                    out.push(distances.reduce((aggr, distance) => {
                        const key = String(distance);
                        const x = Math.round(r + (r + distance) * Math.cos(angle));
                        const y = Math.round(r + (r + distance) * Math.sin(angle));
                        const value = { x, y, sides: {} };

                        sides.forEach((side) => {
                            value.sides[String(side)] = {
                                left: {
                                    x: Math.round(x + side * Math.cos(angle - Math.PI * 0.75)),
                                    y: Math.round(y + side * Math.sin(angle - Math.PI * 0.75)),
                                },
                                right: {
                                    x: Math.round(x + side * Math.cos(angle + Math.PI * 0.75)),
                                    y: Math.round(y + side * Math.sin(angle + Math.PI * 0.75)),
                                },
                            };
                        });

                        aggr[key] = value;
                        return aggr;
                    }, {}));

                }

                console.log(JSON.stringify(out))


            }
            draw();
        </script>
    </body>
</html>

